const translations = {
    en: {
        // General
        "appTitle": "Hellenic Fire Service Live Incidents Map",
        "refresh": "Refresh Data",
        "loading": "Loading...",
        "lastUpdated": "Last Updated",
        "error": "Error",
        "close": "Close",
        
        // Filters
        "filters": "Filters",
        "status": "Status",
        "category": "Category",
        "all": "All",
        "inProgress": "In Progress",
        "partialControl": "Partial Control",
        "fullControl": "Full Control",
        
        // Categories
        "forestFires": "Forest Fires",
        "urbanFires": "Urban Fires",
        "assistance": "Assistance",
        
        // Legend
        "legend": "Legend",
        "forestFireInProgress": "Forest Fire - In Progress",
        "forestFirePartial": "Forest Fire - Partial Control",
        "forestFireControlled": "Forest Fire - Full Control",
        "urbanFireInProgress": "Urban Fire - In Progress",
        "urbanFirePartial": "Urban Fire - Partial Control",
        "urbanFireControlled": "Urban Fire - Full Control",
        "assistanceInProgress": "Assistance - In Progress",
        "assistancePartial": "Assistance - Partial Control",
        "assistanceControlled": "Assistance - Full Control",
        
        // 112 Warnings
        "emergencyWarnings": "Emergency Warnings",
        "warning112Active": "112 Warning - Immediate (0-12h)",
        "warning112Expiring": "112 Warning - Older (12–24 hours). May still be in effect.",
        "warningType": "Warning Type",
        "locations": "Locations",
        "alertTime": "Alert Time",
        "activeWarning": "Immediate",
        "expiredWarning": "Older",
        "message": "Message",
        "noContentAvailable": "No content available",
        "clickForDetails": "Click for details",
        "source": "Source",
        
        // Statistics
        "statistics": "Statistics",
        "totalIncidents": "Total Incidents",
        "forestFireCount": "Forest Fires",
        "urbanFireCount": "Urban Fires",
        "assistanceCount": "Assistance",
        "warningsCount": "112 Warnings",
        
        // Incident details
        "incidentDetails": "Incident Details",
        "region": "Region",
        "municipality": "Municipality",
        "details": "Details",
        "location": "Location",
        "startDate": "Start Date",
        "unknown": "Unknown",
        
        // Footer
        "footer": "Hellenic Fire Service Live Incidents Map",
        
        // Theme
        "darkMode": "Dark Mode",
        "lightMode": "Light Mode",
        
        // Language
        "language": "Language",
        "english": "English",
        "greek": "Greek",

        // Footer
        "footer": "Fire Incidents Map - Hellenic Fire Service",
        "disclaimer": "This is an unofficial application that is not affiliated with, endorsed by, or connected to the Hellenic Fire Service or the Civil Protection.",
        "locationDisclaimer": "All locations are approximate, as there are no official addresses or coordinates, only the municipality.",
        "warning112Disclaimer": "112 warnings are provided for informational purposes only. Some data could not be parsed automatically. Always follow instructions from official authorities.",

        //Civil Protection Daily Map
        "civilmap": "Fire Risk Map",

        // Theme
        "darkMode": "Dark Mode",
        "lightMode": "Light Mode"
    },
    el: {
        // General
        "appTitle": "Συμβάντα Επικράτειας του Πυροσβεστικού Σώματος Ελλάδος",
        "refresh": "Ανανέωση Δεδομένων",
        "loading": "Ενημέρωση...",
        "lastUpdated": "Τελευταία Ενημέρωση",
        "error": "Σφάλμα",
        "close": "Κλείσιμο",
        
        // Filters
        "filters": "Φίλτρα",
        "status": "Κατάσταση",
        "category": "Κατηγορία",
        "all": "Όλα",
        "inProgress": "ΣΕ ΕΞΕΛΙΞΗ",
        "partialControl": "ΜΕΡΙΚΟΣ ΕΛΕΓΧΟΣ",
        "fullControl": "ΠΛΗΡΗΣ ΕΛΕΓΧΟΣ",
        
        // Categories
        "forestFires": "ΔΑΣΙΚΕΣ ΠΥΡΚΑΓΙΕΣ",
        "urbanFires": "ΑΣΤΙΚΕΣ ΠΥΡΚΑΓΙΕΣ",
        "assistance": "ΠΑΡΟΧΕΣ ΒΟΗΘΕΙΑΣ",
        
        // Legend
        "legend": "Υπόμνημα",
        "forestFireInProgress": "Δασική Πυρκαγιά - Σε Εξέλιξη",
        "forestFirePartial": "Δασική Πυρκαγιά - Μερικός Έλεγχος",
        "forestFireControlled": "Δασική Πυρκαγιά - Πλήρης Έλεγχος",
        "urbanFireInProgress": "Αστική Πυρκαγιά - Σε Εξέλιξη",
        "urbanFirePartial": "Αστική Πυρκαγιά - Μερικός Έλεγχος",
        "urbanFireControlled": "Αστική Πυρκαγιά - Πλήρης Έλεγχος",
        "assistanceInProgress": "Παροχή Βοήθειας - Σε Εξέλιξη",
        "assistancePartial": "Παροχή Βοήθειας - Μερικός Έλεγχος",
        "assistanceControlled": "Παροχή Βοήθειας - Πλήρης Έλεγχος",
        
        // 112 Warnings
        "emergencyWarnings": "Προειδοποιήσεις Έκτακτης Ανάγκης",
        "warning112Active": "Προειδοποίηση 112 - Άμεση (0-12ω)",
        "warning112Expiring": "Προειδοποίηση 112 - Παλαιά (12–24 ώρες). Μπορεί να ισχύει ακόμα.",
        "warningType": "Τύπος Προειδοποίησης",
        "locations": "Τοποθεσίες",
        "alertTime": "Χρόνος Συναγερμού",
        "activeWarning": "Άμεση",
        "expiredWarning": "Παλαιά",
        "message": "Μήνυμα",
        "noContentAvailable": "Δεν υπάρχει διαθέσιμο περιεχόμενο",
        "clickForDetails": "Κάντε κλικ για λεπτομέρειες",
        "source": "Πηγή",
        
        // Statistics
        "statistics": "Στατιστικά",
        "totalIncidents": "Συνολικά Περιστατικά",
        "forestFireCount": "Δασικές Πυρκαγιές",
        "urbanFireCount": "Αστικές Πυρκαγιές",
        "assistanceCount": "Παροχές Βοήθειας",
        "warningsCount": "Προειδοποιήσεις 112",
        
        // Incident details
        "incidentDetails": "Λεπτομέρειες Περιστατικού",
        "region": "Περιφέρεια",
        "municipality": "Δήμος",
        "details": "Λεπτομέρειες",
        "location": "Τοποθεσία",
        "startDate": "Ημερομηνία Έναρξης",
        "unknown": "Άγνωστο",
        
        // Footer
        "footer": "Χάρτης Ενεργών Συμβάντων - Δεδομένα από: Πυροσβεστικό Σώμα Ελλάδος",
        
        // Theme
        "darkMode": "Σκούρο Θέμα",
        "lightMode": "Φωτεινό Θέμα",
        
        // Language
        "language": "Γλώσσα",
        "english": "Αγγλικά",
        "greek": "Ελληνικά",

        // Footer
        "footer": "Χάρτης Πυρκαγιών - Δεδομένα Πυροσβεστικού Σώματος Ελλάδος",
        "disclaimer": "Αυτή είναι μια ανεπίσημη εφαρμογή που δεν συνδέεται, δεν υποστηρίζεται και δεν έχει σχέση με το Πυροσβεστικό Σώμα Ελλάδος ή την Πολιτική Προστασία",
        "locationDisclaimer": "Όλες οι τοποθεσίες είναι κατά προσέγγιση, καθώς δεν υπάρχουν επίσημες διευθύνσεις ή συντεταγμένες, μόνο ο δήμος.",
        "warning112Disclaimer": "Οι προειδοποιήσεις 112 παρέχονται μόνο για ενημερωτικούς σκοπούς. Ορισμένα δεδομένα μπορεί να μην έχουν αναγνωριστεί αυτόματα. Ακολουθείτε πάντα τις οδηγίες των αρμόδιων αρχών.",

        //Civil Protection Daily Map
        "civilmap": "Χάρτης Πρόβλεψης Κινδύνου Πυρκαγιάς",
        // Theme
        "darkMode": "Σκούρο Θέμα",
        "lightMode": "Φωτεινό Θέμα"
    }
};

// Current lang
let currentLanguage = localStorage.getItem('preferredLanguage') || 'el';

// change language
function setLanguage(lang) {
    if (translations[lang]) {
        currentLanguage = lang;
        localStorage.setItem('preferredLanguage', lang);
        updatePageTranslations();
    }
}

// get translation
function getText(key) {
    return translations[currentLanguage][key] || translations['en'][key] || key;
}

function updatePageTranslations() {
    document.querySelectorAll('[data-translate]').forEach(element => {
        const key = element.getAttribute('data-translate');
        if (key) {
            if (element.hasAttribute('data-translate-placeholder')) {
                element.placeholder = getText(key);
            } 
            else if (element.hasAttribute('data-translate-attribute')) {
                const attr = element.getAttribute('data-translate-attribute');
                element.setAttribute(attr, getText(key));
            }
            else {
                element.innerText = getText(key);
            }
        }
    });

    document.title = getText('appTitle');
    
    updateSelectOptions();
    
    document.dispatchEvent(new CustomEvent('languageChanged', { detail: { language: currentLanguage } }));
}


// select options
function updateSelectOptions() {
    const statusFilter = document.getElementById('statusFilter');
    if (statusFilter) {

        const currentValue = statusFilter.value;
        
        statusFilter.innerHTML = '';
        
        const allOption = document.createElement('option');
        allOption.value = '';
        allOption.textContent = getText('all');
        statusFilter.appendChild(allOption);
        
        const statuses = [
            { value: 'ΣΕ ΕΞΕΛΙΞΗ', key: 'inProgress' },
            { value: 'ΜΕΡΙΚΟΣ ΕΛΕΓΧΟΣ', key: 'partialControl' },
            { value: 'ΠΛΗΡΗΣ ΕΛΕΓΧΟΣ', key: 'fullControl' }
        ];
        
        statuses.forEach(status => {
            const option = document.createElement('option');
            option.value = status.value;
            option.textContent = getText(status.key);
            statusFilter.appendChild(option);
        });
        
        statusFilter.value = currentValue;
    }
}

document.addEventListener('DOMContentLoaded', function() {
    // browser language and set initial lang
    if (!localStorage.getItem('preferredLanguage')) {
        const browserLang = navigator.language.split('-')[0];
        if (translations[browserLang]) {
            currentLanguage = browserLang;
            localStorage.setItem('preferredLanguage', browserLang);
        }
    }
    
    updatePageTranslations();
    
    // language selector
    const languageSelector = document.getElementById('languageSelector');
    if (languageSelector) {
        languageSelector.value = currentLanguage;
        languageSelector.addEventListener('change', function() {
            setLanguage(this.value);
        });
    }
});

window.translations = {
    getText,
    setLanguage,
    getCurrentLanguage: () => currentLanguage,
    updatePageTranslations
};